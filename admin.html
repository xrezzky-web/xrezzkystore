<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin XREZZKY STORE</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
body{
  margin:0;
  font-family:Inter,-apple-system,sans-serif;
  background:#f0f2f5;
  min-height:100vh;
  display:flex;
  justify-content:center;
  padding:20px;
}
.container{
  width:100%;
  max-width:600px;
  background:#fff;
  padding:25px;
  border-radius:15px;
  box-shadow:0 10px 30px rgba(0,0,0,.1);
}
h1{text-align:center;color:#007bff;margin-bottom:20px;}
label{display:block;margin-top:15px;font-weight:600;font-size:13px;}
input[type=text],textarea{width:100%;padding:10px;margin-top:5px;border-radius:8px;border:1px solid #ccc;font-size:13px;box-sizing:border-box;}
button{padding:10px 15px;margin-top:10px;border:none;border-radius:8px;background:#007bff;color:#fff;font-weight:600;cursor:pointer;transition:.2s;}
button:hover{background:#0056b3;}
.testimoni-list{margin-top:20px;}
.testimoni-item{border:1px solid #eee;padding:10px;border-radius:10px;margin-bottom:10px;display:flex;align-items:center;gap:10px;}
.testimoni-item img{width:50px;height:50px;object-fit:cover;border-radius:8px;}
.testimoni-item .actions{margin-left:auto;display:flex;gap:5px;}
.actions button{background:#dc3545;padding:5px 8px;font-size:12px;color:#fff;border-radius:5px;}
.actions button.edit{background:#28a745;}
</style>
</head>
<body>

<div class="container">
<h1>Admin Panel XREZZKY STORE</h1>

<!-- INFO BOARD -->
<label>Info Board</label>
<textarea id="infoText" placeholder="Tulis info terbaru..." rows="4"></textarea>
<button onclick="updateInfo()">Simpan Info</button>

<!-- TESTIMONI -->
<label>Tambah Testimoni</label>
<input type="text" id="testiName" placeholder="Nama">
<input type="text" id="testiPhoto" placeholder="Link Foto (.jpg/.png)">
<textarea id="testiContent" placeholder="Isi Testimoni" rows="2"></textarea>
<button onclick="addTestimoni()">Tambah Testimoni</button>

<div class="testimoni-list" id="testimoniList"></div>

</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/supabase.min.js"></script>
<script>
// Masukkan Project URL & ANON KEY lo disini
const supabaseUrl = 'https://hxamnrwimmirjckvxjgx.supabase.co';
const supabaseKey = 'sb_publishable_01Icz2_9XjBXpQL8sxIo3w_nHz9foX2';
const supabase = supabase.createClient(supabaseUrl, supabaseKey);

// Load info board
async function loadInfo(){
  let {data,error} = await supabase.from('info').select('*').limit(1).single();
  if(data) document.getElementById('infoText').value = data.text;
}
loadInfo();

// Update info board
async function updateInfo(){
  let text = document.getElementById('infoText').value;
  let {data,error} = await supabase.from('info').upsert({id:1,text:text});
  if(!error) alert('Info berhasil disimpan!');
  else alert('Error: '+error.message);
}

// Load testimoni
async function loadTestimoni(){
  let {data,error} = await supabase.from('testimoni').select('*').order('id',{ascending:true});
  const container = document.getElementById('testimoniList');
  container.innerHTML = '';
  data.forEach(t=>{
    let div = document.createElement('div');
    div.className='testimoni-item';
    div.innerHTML=`
      <img src="${t.photo}" alt="Foto">
      <div>
        <strong>${t.name}</strong>
        <p>${t.content}</p>
      </div>
      <div class="actions">
        <button class="edit" onclick="editTesti(${t.id},'${t.name}','${t.photo}','${t.content.replace(/'/g,"\\'")}')">Edit</button>
        <button onclick="deleteTesti(${t.id})">Hapus</button>
      </div>
    `;
    container.appendChild(div);
  });
}
loadTestimoni();

// Tambah testimoni
async function addTestimoni(){
  const name = document.getElementById('testiName').value;
  const photo = document.getElementById('testiPhoto').value;
  const content = document.getElementById('testiContent').value;
  if(!name||!photo||!content){alert('Semua kolom wajib diisi!');return;}
  let {data,error} = await supabase.from('testimoni').insert([{name,photo,content}]);
  if(!error){
    alert('Testimoni berhasil ditambahkan!');
    document.getElementById('testiName').value='';
    document.getElementById('testiPhoto').value='';
    document.getElementById('testiContent').value='';
    loadTestimoni();
  } else alert('Error: '+error.message);
}

// Edit testimoni
function editTesti(id,name,photo,content){
  document.getElementById('testiName').value=name;
  document.getElementById('testiPhoto').value=photo;
  document.getElementById('testiContent').value=content;
  if(confirm('Simpan perubahan testimoni ini?')){
    supabase.from('testimoni').update({name,photo,content}).eq('id',id).then(res=>{
      loadTestimoni();
      alert('Berhasil diupdate!');
      document.getElementById('testiName').value='';
      document.getElementById('testiPhoto').value='';
      document.getElementById('testiContent').value='';
    });
  }
}

// Hapus testimoni
async function deleteTesti(id){
  if(confirm('Yakin ingin menghapus testimoni ini?')){
    await supabase.from('testimoni').delete().eq('id',id);
    loadTestimoni();
  }
}
</script>
</body>
</html>
